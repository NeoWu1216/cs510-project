<?xml version="1.0" encoding="UTF-8"?>
<TEI xml:space="preserve" xmlns="http://www.tei-c.org/ns/1.0" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xsi:schemaLocation="http://www.tei-c.org/ns/1.0 /mnt/c/Users/pc/Desktop/cs510_proj/grobid-0.5.6/grobid-home/schemas/xsd/Grobid.xsd"
 xmlns:xlink="http://www.w3.org/1999/xlink">
	<teiHeader xml:lang="en">
		<fileDesc>
			<titleStmt>
				<title level="a" type="main">A weighted variational model for simultaneous reflectance and illumination estimation</title>
			</titleStmt>
			<publicationStmt>
				<publisher/>
				<availability status="unknown"><licence/></availability>
			</publicationStmt>
			<sourceDesc>
				<biblStruct>
					<analytic>
						<author>
							<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Xueyang</forename><surname>Fu</surname></persName>
							<affiliation key="aff0">
								<orgName type="department">Fujian Key Laboratory of Sensing and Computing for Smart City</orgName>
								<orgName type="institution">Xiamen University</orgName>
								<address>
									<country key="CN">China</country>
								</address>
							</affiliation>
							<affiliation key="aff1">
								<orgName type="department">School of Information Science and Engineering</orgName>
								<orgName type="institution">Xiamen University</orgName>
								<address>
									<country key="CN">China</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Delu</forename><surname>Zeng</surname></persName>
							<affiliation key="aff0">
								<orgName type="department">Fujian Key Laboratory of Sensing and Computing for Smart City</orgName>
								<orgName type="institution">Xiamen University</orgName>
								<address>
									<country key="CN">China</country>
								</address>
							</affiliation>
							<affiliation key="aff1">
								<orgName type="department">School of Information Science and Engineering</orgName>
								<orgName type="institution">Xiamen University</orgName>
								<address>
									<country key="CN">China</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Yue</forename><surname>Huang</surname></persName>
							<affiliation key="aff0">
								<orgName type="department">Fujian Key Laboratory of Sensing and Computing for Smart City</orgName>
								<orgName type="institution">Xiamen University</orgName>
								<address>
									<country key="CN">China</country>
								</address>
							</affiliation>
							<affiliation key="aff1">
								<orgName type="department">School of Information Science and Engineering</orgName>
								<orgName type="institution">Xiamen University</orgName>
								<address>
									<country key="CN">China</country>
								</address>
							</affiliation>
						</author>
						<author role="corresp">
							<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Xiao-Ping</forename><surname>Zhang</surname></persName>
							<email>xzhang@ee.ryerson.ca</email>
							<affiliation key="aff0">
								<orgName type="department">Fujian Key Laboratory of Sensing and Computing for Smart City</orgName>
								<orgName type="institution">Xiamen University</orgName>
								<address>
									<country key="CN">China</country>
								</address>
							</affiliation>
							<affiliation key="aff2">
								<orgName type="department">Department of Electrical and Computer Engineering</orgName>
								<orgName type="institution">Ryerson University</orgName>
								<address>
									<country key="CA">Canada</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Xinghao</forename><surname>Ding</surname></persName>
							<affiliation key="aff0">
								<orgName type="department">Fujian Key Laboratory of Sensing and Computing for Smart City</orgName>
								<orgName type="institution">Xiamen University</orgName>
								<address>
									<country key="CN">China</country>
								</address>
							</affiliation>
							<affiliation key="aff1">
								<orgName type="department">School of Information Science and Engineering</orgName>
								<orgName type="institution">Xiamen University</orgName>
								<address>
									<country key="CN">China</country>
								</address>
							</affiliation>
						</author>
						<title level="a" type="main">A weighted variational model for simultaneous reflectance and illumination estimation</title>
					</analytic>
					<monogr>
						<imprint>
							<date/>
						</imprint>
					</monogr>
				</biblStruct>
			</sourceDesc>
		</fileDesc>

		<encodingDesc>
			<appInfo>
				<application version="0.5.6" ident="GROBID" when="2019-12-02T16:38+0000">
					<ref target="https://github.com/kermitt2/grobid">GROBID - A machine learning software for extracting information from scholarly documents</ref>
				</application>
			</appInfo>
		</encodingDesc>		<profileDesc>
			<abstract>
<div xmlns="http://www.tei-c.org/ns/1.0"><p>We propose a weighted variational model to estimate both the reflectance and the illumination from an observed image. We show that, though it is widely adopted for ease of modeling, the log-transformed image for this task is not ideal. Based on the previous investigation of the logarithmic transformation, a new weighted variational model is proposed for better prior representation, which is imposed in the regularization terms. Different from conventional variational models, the proposed model can preserve the estimated reflectance with more details. Moreover, the proposed model can suppress noise to some extent. An alternating minimization scheme is adopted to solve the proposed model. Experimental results demonstrate the effectiveness of the proposed model with its algorithm. Compared with other variational methods, the proposed method yields comparable or better results on both subjective and objective assessments.</p></div>
			</abstract>
		</profileDesc>
	</teiHeader>
	<text xml:lang="en">
		<body>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="1.">Introduction</head><p>Observed images can be decomposed as a product of reflectance and illumination using a simplified physical model of light reflection <ref type="bibr" target="#b13">[14]</ref>. In such a decomposition, the illumination represents the light intensity on the objects in the image, and the reflectance represents the physical characteristics of objects. There are many applications derived from this decomposition, such as ordinary image enhancement <ref type="bibr" target="#b23">[24,</ref><ref type="bibr" target="#b32">33,</ref><ref type="bibr" target="#b2">3,</ref><ref type="bibr" target="#b8">9]</ref>, high dynamic range image tone mapping <ref type="bibr" target="#b6">[7,</ref><ref type="bibr" target="#b28">29]</ref>, remote sensing image correction <ref type="bibr" target="#b11">[12]</ref> and target selection and tracking <ref type="bibr" target="#b17">[18,</ref><ref type="bibr" target="#b9">10]</ref>.</p><p>Since estimating the reflectance and the illumination from a single observed image is an ill-posed inverse problem <ref type="bibr" target="#b13">[14]</ref>, a number of modeling approaches have been developed to incorporate prior structural assumptions. For * Correspondence author. example, <ref type="bibr" target="#b13">[14,</ref><ref type="bibr" target="#b12">13]</ref> propose path-based algorithms. These methods require intensive parameter tuning and have high computational complexity, which was later addressed using recursive matrix calculation <ref type="bibr" target="#b4">[5,</ref><ref type="bibr" target="#b20">21]</ref>. Another family of methods use partial differential equations (PDE) <ref type="bibr" target="#b7">[8,</ref><ref type="bibr" target="#b22">23]</ref>, which can be solved efficiently using the fast Fourier transformation (FFT). In <ref type="bibr" target="#b38">[38]</ref>, a nonlocal texture constraint is adopted for decomposing intrinsic images.</p><p>Recently, several variational methods have been presented. In <ref type="bibr" target="#b10">[11]</ref>, Kimmel et al. propose a variational model to estimate the illumination, which is assumed varies smoothly. The assumption of the reflectance is not considered in the model. In <ref type="bibr" target="#b19">[20]</ref>, a total variation (TV) and nonlocal TV regularized model, solved by adopting Bregman iteration, is developed and studied. An L1-based variational model is further introduced in <ref type="bibr" target="#b18">[19]</ref> to focus on estimating the reflectance. In <ref type="bibr" target="#b25">[26]</ref>, a TV model for image decomposition by considering both reflectance and illumination components in the objective function is proposed. The model is divided into two sub-problems and solved by the split Bregman method. However, this method may result in an over-smoothed reflectance due to the side effect of the logarithmic transformation. This method is complemented by using nonlocal bounded variation <ref type="bibr" target="#b34">[35]</ref> to achieve an effective decomposition of illumination and reflectance. Following <ref type="bibr" target="#b25">[26]</ref>, a variational model with barriers for image decomposition is proposed in <ref type="bibr" target="#b33">[34]</ref>. The model is defined as a constrained optimization problem associated with the deduced energy functional. In <ref type="bibr" target="#b15">[16]</ref>, an adaptive perceptually inspired variational model is developed to recover the reflectance and to adjust the uneven intensity distribution. However, the computational cost of this method is high; processing a 1000×1000 image requires about 10 minutes. A kernel-based variational model is introduced in <ref type="bibr" target="#b1">[2]</ref>. An analysis of this model on contrast is provided in the literature. This method can deal with color cast and enhance both under-and over-exposed images. A perception based color correction of digital images in the variational framework is presented in <ref type="bibr" target="#b27">[28,</ref><ref type="bibr" target="#b0">1]</ref>. Both color enhancement and local contrast improvement can be achieved in this method. Meanwhile, a numerical implementation of the gradient descent technique is also shown in these works. Another approach based on a variational Bayesian method is proposed in <ref type="bibr" target="#b31">[32]</ref>. In this literature, the variational Bayes approximation approach is adopted to estimate both the illumination and the reflectance. However, finer details of the estimated reflectance are lost due to the logarithmic transformation. In addition, the computational cost is high since it requires calculations of some linear equations. In <ref type="bibr" target="#b16">[17]</ref>, a higher order TV model for estimating the reflectance and the illumination is proposed. The primal-dual splitting algorithm, which needs to many iterations, is adopted to solve the model. Based on nonlocal differential operators, a unifying model focuses on the reflectance is proposed in <ref type="bibr" target="#b39">[39]</ref>.</p><p>Most of the above variational methods use the logarithmic transformation for pre-processing not only to reduce the computational complexity <ref type="bibr" target="#b29">[30]</ref> but also to simulate human vision perception mechanism, such as Weber's law <ref type="bibr" target="#b30">[31]</ref>. Using the logarithmic transformation to model the fidelity term is proper since the process simulates human eye perception of light intensity. However, since the logarithmic transformation suppresses the variation of gradient magnitude in bright regions, using the gradient in logarithmic domain as the regularization terms is not proper. In other words, solving the ill-posed problem by adopting these regularization terms may lead to an undesirable result, such as loss of finer details in the estimated reflectance.</p><p>In this paper, a weighted variational model for simultaneously estimating reflectance and illumination is presented. First, by analyzing the characteristic of the logarithmic transformation, we show that the logarithmic transformation is not proper to be directly used as regularization terms. Then, based on the previous analysis, a weighted variational model is introduced for better prior representation and an alternating minimization scheme is adopted to solve the proposed model. Unlike existing variational methods using complex techniques, such as nonlocal techniques <ref type="bibr" target="#b34">[35]</ref> and dictionary learning techniques <ref type="bibr" target="#b2">[3]</ref>, the proposed model can achieve significant improvement by simply weighting the widely used regularization terms. Compared with classical variational models, the proposed model can preserve the estimated reflectance with more details. Moreover, the proposed model can suppress noise to some extent. An alternating minimization scheme is adopted to solve the proposed model. Experimental results demonstrate the effectiveness of the proposed model with its algorithm. Compared with other variational methods, the proposed method yields comparable or better results on both subjective and objective assessments.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.">Background: Discussion on log-transform</head><p>The physical model of light reflection can be simply described as S = R·L, where S is the observed image, R is the reflectance of the image within the range (0, 1], and L is the illumination within the range (0, ∞). The dot "·" denotes pixel-wise multiplication and all images are vectorized. It follows that S ≤ L. The goal is to estimate the reflectance R and the illumination L from the observed image S.</p><p>To this end, most variational methods first transform S = R · L into the logarithmic domain, s = r + l, where s = log(S), r = log(R) and l = log(L). Using this logarithmic transformation, the first variational algorithm for this decomposition was proposed in <ref type="bibr" target="#b10">[11]</ref>. This approach only models the illumination l and then estimates the reflectance R by exp(s − l) in post-processing. Another variational method <ref type="bibr" target="#b25">[26]</ref> considers both illumination and reflectance in the objective function, which is arguably more appropriate. However, the directly estimated reflectance images are typically too smooth and loose much of the desired edges and texture details. In <ref type="bibr" target="#b25">[26]</ref>, the authors abandon the directly estimated reflectance and instead use exp(s − l).</p><p>Our goal is to develop an objective function that outputs a usable illumination and reflectance. To this end, we observe that conventional methods use an objective function along the following lines:</p><formula xml:id="formula_0">E(r, l) = l + r − s 2 2 + λ 1 ∇l 2 2 + λ 2 ∇r 1 s.t. r ≤ 0 and s ≤ l.<label>(1)</label></formula><p>In this objective function, the logarithmic illumination l uses a squared penalty to enforce spatial smoothness and the logarithmic reflectance r is encouraged to be piece-wise constant using L1-norm. The fidelity term is the squared error term between the log-transformed image and its breakdown in illumination and reflectance.</p><p>Since the logarithmic transform conforms with human perception of light intensity as described by Weber's law <ref type="bibr" target="#b30">[31]</ref>, it is appropriate to use the logarithmic transformed image to define the fidelity term. However, we argue that the logarithmic transform is not appropriate in the penalty terms on l and r, since it magnifies errors in certain ranges more than others. More specifically, given a target stimulus signal x, its gradient variation is ∇x, and, while in the log-transformed domain it is ∇(log(x)) = 1</p><p>x ∇x. Therefore, when x is very small, the gradient variation in the log-transform ∇(log(x)) is highly weighted by 1</p><p>x . While this too agrees with Weber's law, when the variation ∇(log(x)) = 1</p><p>x ∇x is used in a norm penalty, it inevitably dominates over the variation term in the high magnitude areas. This is not desirable when we estimate/recover the fine details in the high magnitude stimuli areas as well.</p><p>Such phenomenon is illustrated in <ref type="figure" target="#fig_0">Fig 1.</ref> As shown in <ref type="figure" target="#fig_0">Fig. 1(b)</ref>, much structure is amplified in low magnitude s- timuli areas in the log-transformed domain, indicating that these areas are highly weighted by 1</p><p>x . We can see that, when minimizing a norm over this entire image, the intensity of fine edges and details in high illumination areas will be buried in irrelevant details in low illumination areas. This scaling of intensities will make estimating/recovering fine structures in these areas more challenging.</p><p>To preserve edges and details, most existing variational methods use the estimated illumination to estimate the reflectance using the equation R = S/L in post-processing. However, any error in estimated illumination at a pixel, will clearly affect the estimated reflectance at the same location. Intuitively, we argue that a method which can estimate illumination and reflectance simultaneously and accurately should be considered. Based on the above discussion, we also argue that the gradient variation in the log-transformed domain is not proper as a regularization term. In the next section we present a weighted variational model to address this, and derive an alternating minimization algorithm to estimate the illumination and reflectance simultaneously.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.">Model and Algorithm</head><p>As described above, a loss of fine details is incurred by the weight 1</p><p>x in ∇(log(x)) = 1 x ∇x when penalizing the log-transform domain. For better prior representation, it is natural to modify the form of ∇(log(x)), i.e., the regularization terms, to eliminate the weight's impact. Based on the widely used assumptions, a new objective function is established by weighting the regularization terms:</p><formula xml:id="formula_1">E(r, l) = r + l − s 2 2 + c 1 e r · ∇r 1 + c 2 e l · ∇l 2 2 s.t. r ≤ 0 and s ≤ l,<label>(2)</label></formula><p>where c 1 and c 2 are positive parameters, p denotes the p-norm operator. To minimize E(r, l), for the first term ( r + l − s 2 2 ), which corresponds to L2 data fidelity, is to minimize the distance between estimated (r + l) and observed image s. The second term ( e r · ∇r 1 ), which corresponds to TV reflectance sparsity, enforces piece-wise constant on the reflectance r. The third term ( e l · ∇l 2 ) enforces spatial smoothness on the illumination l. Note that the ∇r and ∇l are respectively weighted by e r and e l to eliminate the impact of 1 R and 1 L . Since e r and ∇r are coupled in the second term and e l and ∇l are coupled in the third term, minimizing the objective function <ref type="formula" target="#formula_1">(2)</ref> is difficult. However, eliminating the impact of the weights, i.e., 1 r and 1 l , in regularization terms can better represent the prior knowledge. Thus, we build a new objective function which is easy to minimize, besides, it can effectively eliminate the impact of the weights. Note that e r = R and e l = L can be computed by using the previous results and seen as constant vectors. Based on this strategy, the new objective function at the kth iteration is:</p><formula xml:id="formula_2">E(r k , l k ) = r k + l k − s 2 2 + c 1 R k−1 · ∇r k 1 + c 2 L k−1 · ∇l k 2 2 s.t. r k ≤ 0 and s ≤ l k ,<label>(3)</label></formula><p>Since there are two unknowns in the objective function, traditional gradient descent methods are unusable. In this paper, an alternating direction method of multipliers (AD-MM) <ref type="bibr" target="#b5">[6]</ref> is adopted to solve the objective function. For the L1-norm, an auxiliary variable d and an error b are introduced and function <ref type="formula" target="#formula_2">(3)</ref> is rewritten as:</p><formula xml:id="formula_3">E(r k , l k ,d k , b k ) = r k + l k − s 2 2 + c 2 L k−1 · ∇l k 2 2 + c 1 { d k 1 + λ R k−1 · ∇r k − d k + b k 2 2 } s.t. r k ≤ 0 and s ≤ l k .<label>(4)</label></formula><p>This objective function will have local minima according to ADMM theory <ref type="bibr" target="#b5">[6]</ref>. Three separate sub-problems are iteratively cycled through. In particular, for the kth iteration:</p><formula xml:id="formula_4">(P 1) d k = arg min d d 1 + λ R k−1 · ∇r k−1 − d + b k−1 2 2 , (P 2) r k = arg min r r + l k−1 − s 2 2 + c 1 λ R k−1 · ∇r − d k + b k−1 2 2 , b k = b k−1 + R k · ∇r k − d k , (P 3) l k = arg min l l + r k − s 2 2 + c 2 L k−1 · ∇l 2 2 .</formula><p>The three sub-problems have closed form global optimal solutions. The update for b k follows from ADMM. The algorithm is detailed as follows:</p><p>1) Algorithm for P 1 A shrinkage operation is adopted to update d k at the kth iteration:</p><formula xml:id="formula_5">d k h = shrink(R k−1 · ∇ h r k−1 + b k−1 h , 1 2λ ), d k v = shrink(R k−1 · ∇ v r k−1 + b k−1 v , 1 2λ ),<label>(5)</label></formula><p>where shrink(x, λ) = x |x| * max(|x| − λ, 0) with x |x| equal to 0 when |x| = 0. h and v are the horizontal and vertical directions, respectively.</p><p>2) Algorithm for P 2 Since P 2 is a least squares problem, r k has a closed form solution. The Fast Fourier Transformation (FFT) is adopted to speed up the process. By setting the first-order derivative to zero, r k is updated by the following expression:</p><formula xml:id="formula_6">r k = F −1 ( F (s − l k−1 ) + c1λΦ F (U)+c1λR k−1 · (F * (∇ h ) · F (∇ h ) + F * (∇v) · F (∇v)) ),<label>(6)</label></formula><p>where U is the identity matrix,</p><formula xml:id="formula_7">Φ = F * (∇ h ) · F (d k h − b k−1 h ) + F * (∇ v ) · F (d k v − b k−1 v )</formula><p>, F is the FFT operator, F * is the conjugate transpose and F −1 is the inverse FFT operator. The derivative operator is diagonalized after FFT so that matrix inversion can be avoided. All calculations are performed pixel-wise. According to the prior: r ≤ 0, a simple correction is made after r k is updated: r k = min(r k , 0).</p><p>Updating b k by the following expression:</p><formula xml:id="formula_8">b k h = b k−1 h + R k · ∇ h r k − d k h , b k v = b k−1 v + R k · ∇ v r k − d k v .<label>(7)</label></formula><p>This operation is the similar to "adding back the noise" used in TV denoising <ref type="bibr" target="#b26">[27]</ref>. d, r and b are updated until ε r = ( r k − r k−1 / r k−1 ) ≤ ε 1 .</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>3) Algorithm for P 3</head><p>Since P 3 is also a least squares problem, updating l k is similar to r k :</p><formula xml:id="formula_9">l k = F −1 ( F (s − r k ) F (U)+c2L k−1 (F * (∇ h ) · F (∇ h ) + F * (∇v) · F (∇v))</formula><p>).</p><p>According to the prior: s ≤ l, a simple correction is made after l k is updated: l k = max(l k , s). l is updated until ε l = ( l k − l k−1 / l k−1 ) ≤ ε 2 . Since large-matrix inversion is avoided by FFT and the shrinkage operation is fast due to requiring only a few operations, r and l can be solved simultaneously and efficiently. The final estimated reflectance and illumination are obtained by R = e r and L = e l , respectively. In the next section, experimental results are presented to demonstrate the effectiveness of the proposed method.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4.">Experimental Results</head><p>All experiments are performed using our unoptimized Matlab implementation 1 on a PC with Intel Core i5 CPU 4460, 8GB RAM. We compare the proposed model with other two classical models: Kimmel's model <ref type="bibr" target="#b10">[11]</ref> and Ng's model <ref type="bibr" target="#b25">[26]</ref>. For fair comparison, the parameters used in the two methods are set to be optimal according to <ref type="bibr" target="#b10">[11]</ref> and <ref type="bibr" target="#b25">[26]</ref>. In our experiments, the empirical parameters c 1 , c 2 and λ are set at 0.01, 0.1 and 1, respectively. For the stopping parameters, ε 1 and ε 2 are set to be 10 −3 . The initial value R 0 = 0, b 0 = 0, ε r = 10 and ε l = 10 . In general, there are two approaches for dealing with the color images <ref type="bibr" target="#b10">[11,</ref><ref type="bibr" target="#b25">26]</ref>. More precisely, one approach processes each color channel (Red, Green, and Blue) separately to improve the colors or correct color distortion. Another approach is to transform color images into the HSV (Hue, Saturation and Value) space and only process the V-channel, and then transform it back to the RGB domain.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Reflectance and Illumination Estimation</head><p>First, two comparisons of reflectance and illumination estimation are shown in <ref type="figure" target="#fig_1">Figs. 2 and 3. Fig. 2</ref> shows the comparison in the RGB domain and <ref type="figure" target="#fig_1">Fig. 3</ref> shows the comparison in the HSV domain. Since the reflectance is not considered in Kimmel's model <ref type="bibr" target="#b10">[11]</ref>, only Ng's estimated reflectance <ref type="bibr" target="#b25">[26]</ref> is shown. The results in <ref type="figure">Fig. 2</ref> include color information since the algorithms are applied to each RGB channel separately. As can be seen, the illumination estimated by our model is more smooth than other two methods. In other words, our results are more conform with the illumination's prior of spatial smoothness. Though Ng's method <ref type="bibr" target="#b25">[26]</ref> considers the reflectance into the model to make it more appropriate and reasonable for the decomposition, the directly estimated reflectance images shown in Figs. 2(e) and 3(e) appear fuzzy and lose finer details. This is due to the side effect of the logarithmic transformation discussed in Section 2. As can be seen in Figs. 2(f) and 3(f), our reflectance images effectively preserve details and are clearer than that by the Ng's method. Meanwhile, since the illumination is removed, details in dark areas are revealed in the reflectance. Since it is hard to obtain the ground truth of both the reflectance and the illumination, how to quantitatively assess the estimation is a tough problem. In the following content, different experiments are designed to demonstrate the effectiveness of the proposed model and algorithm.</p><p>Illumination Adjustment Since the illumination contains the lightness information, removing or adjusting the illumination can generate visually pleasing results for dark images. Therefore, the Gamma correction operation is adopted to modify the estimated illumination. Same as in <ref type="bibr" target="#b10">[11,</ref><ref type="bibr" target="#b25">26]</ref>, the Gamma correction of L with an adjusting parameter γ is defined by:</p><formula xml:id="formula_11">L ′ = W L W 1 γ ,<label>(9)</label></formula><p>where W is 255 in an 8-bit image and the empirical parameter γ is set as 2.2. Since the method <ref type="bibr" target="#b10">[11]</ref> only estimates the illumination and the method <ref type="bibr" target="#b25">[26]</ref> obtains a fuzzy re-(a) input (b) illumination by <ref type="bibr" target="#b10">[11]</ref> (c) illumination by <ref type="bibr" target="#b25">[26]</ref> (d) our illumination (e) reflectance by <ref type="bibr" target="#b25">[26]</ref> (f) our reflectance <ref type="figure">Figure 2</ref>. Comparison of reflectance and illumination estimation in the RGB domain.</p><p>(a) input (b) illumination by <ref type="bibr" target="#b10">[11]</ref> (c) illumination by <ref type="bibr" target="#b25">[26]</ref> (d) our illumination (e) reflectance by <ref type="bibr" target="#b25">[26]</ref> (f) our reflectance flectance, the enhanced images of the two methods is computed by:</p><formula xml:id="formula_12">S enhanced = ( S L ) · L ′ .<label>(10)</label></formula><p>While our estimated reflectance preserves finer details, the enhanced image of the proposed method is computed by: <ref type="figure" target="#fig_2">Fig. 4</ref> shows some examples of illumination adjustment by different methods. A classical image enhancement algorithm based on the center/surround Retinex: multiscale Retinex with color restoration (MSRCR) <ref type="bibr" target="#b8">[9]</ref> is also adopted to make a comparison. To preserve color information, the Gamma correction is processed in the HSV domain. As can be seen, MSRCR can effectively enhance details and contrast with color correction. However, this method has over-enhancement to some degree since the estimated illumination is directly removed. The global visual effect of the proposed method is similar to the other two variational methods <ref type="bibr" target="#b10">[11,</ref><ref type="bibr" target="#b25">26]</ref>. This is because adding corrected illumination back to reflectance is a complementary process. However, the proposed method has a better natural performance, such as shadow areas of background in the first row and the clouds in the third row.</p><formula xml:id="formula_13">S enhanced = R · L ′ .<label>(11)</label></formula><p>Since the ground truth of the enhanced image is unknown, a blind image quality assessment is used to evaluate the enhanced results. This metric is the natural image quality evaluator (NIQE) <ref type="bibr" target="#b21">[22]</ref> based on statistical regularities from natural and undistorted images. A lower NIQE value represents a higher image quality and the best results are boldfaced. As shown in <ref type="table" target="#tab_0">Table 1</ref>, the proposed method has a lower average than other three methods, in agreement with the our empirical assessment of having the highest quality of enhanced results. We also test 300 images with different illumination conditions to demonstrate the effectiveness of our model on the Gamma correction. The tested 300 images are selected from the non-uniform illumination image dataset <ref type="bibr" target="#b32">[33]</ref>, the nighttime image dataset <ref type="bibr" target="#b3">[4]</ref>, the NASA image dataset <ref type="bibr" target="#b24">[25]</ref> and the Google image searching. The 300 images are categorized into 16 backlit images, 123 non-uniform illumination images and 164 night-time images. <ref type="table">Table 2</ref> shows corresponding average NIQE values of the three categories. As shown in <ref type="table">Table 2</ref>, the proposed method has the lowest NIQE value on most images, which indicates that our model has a consistent good performance on different kinds of images.</p><p>Noise Suppression An important problem of dark image enhancement is how to suppress noise in dark areas when applying the Gamma correction. Two dark images contaminated with slight additive white Gaussian noise n with σ = 5 are processed. Figs. 5 and 6 show the enhanced (a) inputs (b) results by <ref type="bibr" target="#b8">[9]</ref> (c) results by <ref type="bibr" target="#b10">[11]</ref> (d) results by <ref type="bibr" target="#b25">[26]</ref> (e) our results (a) clean image (b) noisy image (c) enhanced results by <ref type="bibr" target="#b10">[11]</ref> (d) enhanced results by <ref type="bibr" target="#b25">[26]</ref> (e) our enhanced results <ref type="figure">Figure 5</ref>. Comparison of noise suppression.</p><p>(a) clean image (b) noisy image (c) enhanced results by <ref type="bibr" target="#b10">[11]</ref> (d) enhanced results by <ref type="bibr" target="#b25">[26]</ref> (e) our enhanced results results with corresponding enlargements in red rectangles. The Gamma correction is processed in the HSV domain. For methods <ref type="bibr" target="#b10">[11,</ref><ref type="bibr" target="#b25">26]</ref>, the Gamma correction only relies on the estimated illumination, i.e.,</p><formula xml:id="formula_14">S enhanced = S L · L ′ = (R · L + n) · L ′ L .<label>(12)</label></formula><p>It is clear that noise will be amplified after Gamma correction since L ≤ L ′ according to Eq. <ref type="bibr" target="#b9">(10)</ref>. As can be seen in Figs. 5(c) and (d) and Figs. 6(c) and (d), both Kimmel's method <ref type="bibr" target="#b10">[11]</ref> and Ng's method <ref type="bibr" target="#b25">[26]</ref> amplify the noise after Gamma correction. Since the proposed model estimates reflectance and illumination simultaneously, the L1 regularization term in function (2) can effectively handle noise.</p><p>Color Correction As mentioned before, when each RG-B channel is estimated separately, the estimated reflectance and illumination contains color information. By removing the illumination, the reflectance retains the original color information of the object, meaning that the proposed model (a) input (b) ground truth (c) results by <ref type="bibr" target="#b10">[11]</ref> (d) results by <ref type="bibr" target="#b25">[26]</ref> (e) our results <ref type="figure">Figure 7</ref>. Comparison of color correction.</p><p>(a) input (b) ground truth (c) results by <ref type="bibr" target="#b10">[11]</ref> (d) results by <ref type="bibr" target="#b25">[26]</ref> (e) our results  has the effect of color correction. In this experiment, the color correction performance is shown in Figs. 7 and 8 to demonstrate the accuracy of the estimated reflectance and illumination. The S-CIELAB color metric <ref type="bibr" target="#b37">[37]</ref> based on spatial processing to measure color errors is adopted to verify the accuracy of color correction. The third rows in Figs. 7 and 8 are the corrected results obtained by methods <ref type="bibr" target="#b10">[11,</ref><ref type="bibr" target="#b25">26]</ref> and the proposed one, respectively. The third rows in Figs. 7 and 8 are the spatial location of the errors between the ground truth and other corrected results. The fourth rows in Figs. 7 and 8 are histograms of S-CIELAB errors of the ground truth with other three results, respectively. As can be seen from the spatial locations of the errors, the green areas of our result are smaller than those of other two methods. This indicates that the difference between the ground truth and our result is the smallest, which also can be seen from the histogram distribution of errors. This experiment demonstrates that the proposed model can estimate more accurate results when dealing with color distorted images.</p><p>Parameters Impact The impact of regularization parameters c 1 and c 2 on the proposed model <ref type="formula" target="#formula_1">(2)</ref> is shown in <ref type="figure" target="#fig_6">Fig. 9</ref>.</p><p>The default values are set as 0.01 and 0.1. To test the impact of different parameters respectively, we change the value of one parameter while keeping the other one unchanged. As can be seen in <ref type="figure" target="#fig_6">Fig. 9</ref>, details of estimated reflectance are fuzzed since L1 term decreases as c 1 increases. The estimated illumination smoothed as c 2 increases since c 2 controls the smoothness. In most cases, the empirical setting of regularization parameters generates satisfactory results.</p><p>Convergence Rate and Computational Time First, the convergence rate of the proposed algorithm is analyzed. The operation is processed in the HSV domain with a 512 × 512 image. <ref type="figure" target="#fig_0">Fig. 10</ref> shows the relationship between the error ε r , ε l and the number of iterations. As shown from the error curve, the convergence rate is fast. This is due to the approximation strategy and the alternating optimization algorithm are adopted to split the non-convex objective function (2) into three sub-problems that have closed form solutions.</p><p>The computational time is also tested since it is an important factor of an algorithm. One hundred images with size of 512 × 512 are processed with different stopping parameters ε 1 and ε 2 . The operation is processed in the HSV domain and average computational times are shown in <ref type="table">Table 3</ref>. As can be seen, the smaller stopping parameters is, the higher computational time required. This is due more iterations are required to achieve a smaller error. Note that the experiments are performed by unoptimized Matlab implementation and the computational time can be further improved by C programming and advanced computing devices.</p><p>Extension: Illumination Invariant Facial Images Finally, the proposed model is used to process illumination invariant facial images. In this experiment, the reflectance is estimated by the new model over four images <ref type="bibr" target="#b14">[15,</ref><ref type="bibr" target="#b35">36]</ref> under different illumination conditions. As can be seen in <ref type="figure" target="#fig_0">Fig.  11</ref>, though the person's face is affected by different lighting conditions, the estimated reflectance is similar since the illumination is well estimated and eliminated from the observed images. This experiment shows that the proposed model has the potential to be used in other computer vision applications.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="5.">Conclusion</head><p>In this paper, a new weighted variational model for simultaneous estimation of reflectance and illumination is introduced. First, we show the side effect of the logarithmic transformation. Based on the analysis of the logarithmic transformation, a weighted variational model is introduced to refine the regularization terms for better prior representation. An alternating minimization algorithm with an approximation strategy is adopted to estimate the model. We present a comprehensive experimental analysis of the proposed model using both subjective and objective assessments. Compared with other testing methods, the proposed one shows similar or even better results with satisfactory convergence rate and computational times.</p></div><figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_0"><head>Figure 1 .</head><label>1</label><figDesc>Example of logarithmic transformation.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_1"><head>Figure 3 .</head><label>3</label><figDesc>Comparison of reflectance and illumination estimation in the HSV domain. The results look gray because we only show the estimated illumination and reflectance of the V-channel without Hue and Saturation.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_2"><head>Figure 4 .</head><label>4</label><figDesc>Comparison of illumination adjustment.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_3"><head>Figure 6 .</head><label>6</label><figDesc>Comparison of noise suppression.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_4"><head>Figure 8 .</head><label>8</label><figDesc>Comparison of color correction.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_5"><head>Figure 10 .</head><label>10</label><figDesc>The relation between εr, εl and iteration numbers.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_6"><head>Figure 9 .</head><label>9</label><figDesc>Examples of parameters impact. First row: estimated illumination images. Second row: estimated reflectance images.Table 3. Average computational times in secondsε 1 = ε 2 = 0.1 ε 1 = ε 2 = 0.01 ε 1 = ε 2</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_7"><head>Figure 11 .</head><label>11</label><figDesc>Processing illumination invariant facial images.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_0" validated="true"><head>Table 1 .</head><label>1</label><figDesc>Average NIQE values ofFig. 4</figDesc><table>inputs [9] 
[11] [26] ours 

1st row 
2.47 
2.35 3.18 2.45 2.13 
2nd row 
2.52 
2.32 2.70 2.42 2.38 
3rd row 
3.97 
3.54 3.91 3.46 3.72 
4th row 
3.10 
2.93 3.62 3.16 2.77 
Average 
3.02 
2.79 3.35 2.87 2.75 

Table 2. Average NIQE values on 300 images 

inputs [9] 
[11] [26] ours 

Backlit 
4.01 
3.68 3.43 3.37 3.51 
Non-uniform 
3.47 
3.28 3.25 3.33 3.17 
night-time 
5.12 
5.01 4.55 4.51 4.21 

</table></figure>
			<note xmlns="http://www.tei-c.org/ns/1.0" place="foot" n="1">We share our Matlab implementation at: http://smartdsp. xmu.edu.cn/cvpr2016.html</note>
		</body>
		<back>

			<div type="acknowledgement">
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="6.">Acknowledgements</head><p>We would like to thank the anonymous reviewers for their helpful feedback. This work was supported in part by the National Natural Science </p></div>
			</div>

			<div type="references">

				<listBibl>

<biblStruct xml:id="b0">
	<analytic>
		<title level="a" type="main">Perceptual color correction through variational techniques</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><surname>Bertalmío</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">V</forename><surname>Caselles</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">E</forename><surname>Provenzi</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">A</forename><surname>Rizzi</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">IEEE Trans. Image Process</title>
		<imprint>
			<biblScope unit="volume">16</biblScope>
			<biblScope unit="issue">4</biblScope>
			<biblScope unit="page" from="1058" to="1072" />
			<date type="published" when="2007" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b1">
	<analytic>
		<title level="a" type="main">Issues about Retinex theory and contrast enhancement</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><surname>Bertalmío</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">V</forename><surname>Caselles</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">E</forename><surname>Provenzi</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Int. J. Comput. Vision</title>
		<imprint>
			<biblScope unit="volume">83</biblScope>
			<biblScope unit="issue">1</biblScope>
			<biblScope unit="page" from="101" to="119" />
			<date type="published" when="2009" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b2">
	<analytic>
		<title level="a" type="main">Retinex image enhancement via a learned dictionary</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">H</forename><surname>Chang</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><forename type="middle">K</forename><surname>Ng</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">W</forename><surname>Wang</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">T</forename><surname>Zeng</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Optical Engineering</title>
		<imprint>
			<biblScope unit="volume">54</biblScope>
			<biblScope unit="issue">1</biblScope>
			<biblScope unit="page" from="13107" to="13108" />
			<date type="published" when="2015" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b3">
	<analytic>
		<title level="a" type="main">Quality assessment for comparing image enhancement algorithms</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Z</forename><surname>Chen</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">T</forename><surname>Jiang</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Y</forename><surname>Tian</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">IEEE Conference on Computer Vision and Pattern Recognition (CVPR)</title>
		<meeting><address><addrLine>Ohio</addrLine></address></meeting>
		<imprint>
			<date type="published" when="2014-06" />
			<biblScope unit="page" from="3003" to="3010" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b4">
	<analytic>
		<title level="a" type="main">Retinex in matlab</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">B</forename><surname>Funt</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">F</forename><surname>Ciurea</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><surname>Mccann</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Electron. Imaging</title>
		<imprint>
			<biblScope unit="volume">13</biblScope>
			<biblScope unit="issue">1</biblScope>
			<biblScope unit="page" from="48" to="57" />
			<date type="published" when="2004" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b5">
	<analytic>
		<title level="a" type="main">The split Bregman method for L1-regularized problems</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">T</forename><surname>Goldstein</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">S</forename><surname>Osher</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">SIAM J. Imaging Sci</title>
		<imprint>
			<biblScope unit="volume">2</biblScope>
			<biblScope unit="issue">2</biblScope>
			<biblScope unit="page" from="323" to="343" />
			<date type="published" when="2009" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b6">
	<analytic>
		<title level="a" type="main">Local edge-preserving multiscale decomposition for high dynamic range image tone mapping</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">B</forename><surname>Gu</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">W</forename><surname>Li</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><surname>Zhu</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><surname>Wang</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">IEEE Trans. Image Process</title>
		<imprint>
			<biblScope unit="volume">22</biblScope>
			<biblScope unit="issue">1</biblScope>
			<biblScope unit="page" from="70" to="79" />
			<date type="published" when="2013" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b7">
	<analytic>
		<title level="a" type="main">Determining lightness from an image. Comput</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">B</forename><forename type="middle">K P</forename><surname>Horn</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Graphics Image Process</title>
		<imprint>
			<biblScope unit="volume">3</biblScope>
			<biblScope unit="issue">4</biblScope>
			<biblScope unit="page" from="277" to="299" />
			<date type="published" when="1974" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b8">
	<analytic>
		<title level="a" type="main">A multiscale Retinex for bridging the gap between color images and the human observation of scenes</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">D</forename><forename type="middle">J</forename><surname>Jobson</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Z</forename><forename type="middle">U</forename><surname>Rahman</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">G</forename><forename type="middle">A</forename><surname>Woodell</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">IEEE Trans. Image Process</title>
		<imprint>
			<biblScope unit="volume">6</biblScope>
			<biblScope unit="issue">7</biblScope>
			<biblScope unit="page" from="965" to="976" />
			<date type="published" when="1997" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b9">
	<analytic>
		<title level="a" type="main">Eye detection under varying illumination using the Retinex theory</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">C</forename><surname>Jung</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">T</forename><surname>Sun</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">L</forename><surname>Jiao</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Neurocomput</title>
		<imprint>
			<biblScope unit="volume">113</biblScope>
			<biblScope unit="page" from="130" to="137" />
			<date type="published" when="2013" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b10">
	<analytic>
		<title level="a" type="main">A variational framework for Retinex</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">R</forename><surname>Kimmel</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><surname>Elad</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">D</forename><surname>Shaked</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">R</forename><surname>Keshet</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">I</forename><surname>Sobel</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Int. J. Comput. Vision</title>
		<imprint>
			<biblScope unit="volume">52</biblScope>
			<biblScope unit="issue">1</biblScope>
			<biblScope unit="page" from="7" to="23" />
			<date type="published" when="2003" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b11">
	<analytic>
		<title level="a" type="main">A spatially adaptive Retinex variational model for the uneven intensity correction of remote sensing images</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">X</forename><surname>Lan</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">H</forename><surname>Shen</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">L</forename><surname>Zhang</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Q</forename><surname>Yuan</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Signal Process</title>
		<imprint>
			<biblScope unit="volume">101</biblScope>
			<biblScope unit="page" from="19" to="34" />
			<date type="published" when="2014" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b12">
	<analytic>
		<title level="a" type="main">The Retinex theory of color vision</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">E</forename><forename type="middle">H</forename><surname>Land</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Sci. Amer</title>
		<imprint>
			<date type="published" when="1977" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b13">
	<analytic>
		<title level="a" type="main">Lightness and Retinex theory</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">E</forename><forename type="middle">H</forename><surname>Land</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><forename type="middle">J</forename><surname>Mccann</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Opt. Soc. Am</title>
		<imprint>
			<biblScope unit="volume">61</biblScope>
			<biblScope unit="issue">1</biblScope>
			<biblScope unit="page" from="1" to="11" />
			<date type="published" when="1971" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b14">
	<analytic>
		<title level="a" type="main">Acquiring linear subspaces for face recognition under variable lighting</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">K</forename><forename type="middle">C</forename><surname>Lee</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><surname>Ho</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">D</forename><forename type="middle">J</forename><surname>Kriegman</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">IEEE Trans. Pattern Anal. Mach. Intell</title>
		<imprint>
			<biblScope unit="volume">27</biblScope>
			<biblScope unit="issue">5</biblScope>
			<biblScope unit="page" from="684" to="698" />
			<date type="published" when="2005" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b15">
	<analytic>
		<title level="a" type="main">A perceptually inspired variational method for the uneven intensity correction of remote sensing images</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">H</forename><surname>Li</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">L</forename><surname>Zhang</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">H</forename><surname>Shen</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">IEEE Trans. Geosci. Remote Sens</title>
		<imprint>
			<biblScope unit="volume">50</biblScope>
			<biblScope unit="issue">8</biblScope>
			<biblScope unit="page" from="3053" to="3065" />
			<date type="published" when="2012" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b16">
	<analytic>
		<title level="a" type="main">Retinex by higher order total variation decomposition</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><surname>Liang</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">X</forename><surname>Zhang</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Math. Imaging Vis</title>
		<imprint>
			<biblScope unit="volume">52</biblScope>
			<biblScope unit="issue">3</biblScope>
			<biblScope unit="page" from="345" to="355" />
			<date type="published" when="2015" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b17">
	<analytic>
		<title level="a" type="main">Using Retinex for point selection in 3D shape registration</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Y</forename><surname>Liu</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">R</forename><forename type="middle">R</forename><surname>Martin</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">L</forename><forename type="middle">D</forename><surname>Domincis</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">B</forename><surname>Li</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Pattern Recogn</title>
		<imprint>
			<biblScope unit="volume">47</biblScope>
			<biblScope unit="issue">6</biblScope>
			<biblScope unit="page" from="2126" to="2142" />
			<date type="published" when="2014" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b18">
	<analytic>
		<title level="a" type="main">An L1-based variational model for Retinex theory and its applications to medical images</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">W</forename><surname>Ma</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><forename type="middle">M</forename><surname>Morel</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">S</forename><surname>Osher</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">A</forename><surname>Chien</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">IEEE Conference on Computer Vision and Pattern Recognition (CVPR)</title>
		<imprint>
			<date type="published" when="2011" />
			<biblScope unit="page" from="153" to="160" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b19">
	<analytic>
		<title level="a" type="main">A TV bregman iterative model of Retinex theory</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">W</forename><surname>Ma</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">S</forename><surname>Osher</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Inverse Problems and Imaging</title>
		<imprint>
			<biblScope unit="volume">6</biblScope>
			<biblScope unit="issue">4</biblScope>
			<biblScope unit="page" from="697" to="708" />
			<date type="published" when="2012" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b20">
	<analytic>
		<title level="a" type="main">Lessons learned from mondrians applied to real images and color gamuts</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><surname>Mccann</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proc. IS&amp;T/SID 7th Color Imag. Conf</title>
		<meeting>IS&amp;T/SID 7th Color Imag. Conf</meeting>
		<imprint>
			<date type="published" when="1999" />
			<biblScope unit="page" from="1" to="8" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b21">
	<analytic>
		<title level="a" type="main">Making a completely blind image quality analyzer</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">A</forename><surname>Mittal</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">R</forename><surname>Soundararajan</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">A</forename><forename type="middle">C</forename><surname>Bovik</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">IEEE Signal Process. Lett</title>
		<imprint>
			<biblScope unit="volume">20</biblScope>
			<biblScope unit="issue">3</biblScope>
			<biblScope unit="page" from="209" to="212" />
			<date type="published" when="2013" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b22">
	<analytic>
		<title level="a" type="main">A PDE formalization of Retinex theory</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><forename type="middle">M</forename><surname>Morel</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">A</forename><forename type="middle">B</forename><surname>Petro</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">C</forename><surname>Sbert</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">IEEE Trans. Image Process</title>
		<imprint>
			<biblScope unit="volume">19</biblScope>
			<biblScope unit="issue">11</biblScope>
			<biblScope unit="page" from="2825" to="2837" />
			<date type="published" when="2010" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b23">
	<analytic>
		<title level="a" type="main">Power-constrained contrast enhancement algorithm using multi-scale Retinex for oled display</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Y</forename><surname>Nam</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">D</forename><surname>Choi</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">B</forename><surname>Song</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">IEEE Trans. Image Process</title>
		<imprint>
			<biblScope unit="volume">23</biblScope>
			<biblScope unit="issue">8</biblScope>
			<biblScope unit="page" from="3308" to="3320" />
			<date type="published" when="2014" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b24">
	<monogr>
		<title level="m" type="main">Retinex image processing</title>
		<ptr target="http://dragon.larc.nasa.gov/retinex/pao/news/" />
		<imprint>
			<date type="published" when="2001" />
		</imprint>
		<respStmt>
			<orgName>NASA</orgName>
		</respStmt>
	</monogr>
</biblStruct>

<biblStruct xml:id="b25">
	<analytic>
		<title level="a" type="main">A total variation model for Retinex</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><forename type="middle">K</forename><surname>Ng</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">W</forename><surname>Wang</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">SIAM J. Imaging Sci</title>
		<imprint>
			<biblScope unit="volume">4</biblScope>
			<biblScope unit="issue">1</biblScope>
			<biblScope unit="page" from="345" to="365" />
			<date type="published" when="2011" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b26">
	<analytic>
		<title level="a" type="main">An iterative regularization method for total variation-based image restoration</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">S</forename><surname>Osher</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><surname>Burger</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">D</forename><surname>Goldfarb</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><surname>Xu</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">W</forename><surname>Yin</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Multiscale Model. Simul</title>
		<imprint>
			<biblScope unit="volume">4</biblScope>
			<biblScope unit="issue">2</biblScope>
			<biblScope unit="page" from="460" to="489" />
			<date type="published" when="2005" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b27">
	<analytic>
		<title level="a" type="main">A perceptually inspired variational framework for color enhancement</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">R</forename><surname>Palma-Amestoy</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">E</forename><surname>Provenzi</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><surname>Bertalmío</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">V</forename><surname>Caselles</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">IEEE Trans. Pattern Anal. Mach. Intell</title>
		<imprint>
			<biblScope unit="volume">31</biblScope>
			<biblScope unit="issue">3</biblScope>
			<biblScope unit="page" from="458" to="474" />
			<date type="published" when="2009" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b28">
	<analytic>
		<title level="a" type="main">Adapting iterative Retinex computation for high-dynamic-range tone mapping</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">S</forename><surname>Pan</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">X</forename><surname>An</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">H</forename><surname>He</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Electron. Imaging</title>
		<imprint>
			<biblScope unit="volume">22</biblScope>
			<biblScope unit="issue">2</biblScope>
			<biblScope unit="page" from="23006" to="23007" />
			<date type="published" when="2013" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b29">
	<analytic>
		<title level="a" type="main">Mathematical definition and analysis of the Retinex algorithm</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">E</forename><surname>Provenzi</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">L</forename><forename type="middle">D</forename><surname>Carli</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">A</forename><surname>Rizzi</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">D</forename><surname>Marini</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Opt. Soc. Amer. A</title>
		<imprint>
			<biblScope unit="volume">22</biblScope>
			<biblScope unit="issue">12</biblScope>
			<biblScope unit="page" from="2613" to="2621" />
			<date type="published" when="2005" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b30">
	<monogr>
		<title level="m" type="main">Fundamentals of electronic imaging systems</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">W</forename><forename type="middle">F</forename><surname>Schreiber</surname></persName>
		</author>
		<imprint>
			<date type="published" when="1986" />
			<publisher>Springer</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b31">
	<analytic>
		<title level="a" type="main">Variational Bayesian method for Retinex</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">L</forename><surname>Wang</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">L</forename><surname>Xiao</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">H</forename><surname>Liu</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Z</forename><surname>Wei</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">IEEE Trans. Image Process</title>
		<imprint>
			<biblScope unit="volume">23</biblScope>
			<biblScope unit="issue">8</biblScope>
			<biblScope unit="page" from="3381" to="3396" />
			<date type="published" when="2014" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b32">
	<analytic>
		<title level="a" type="main">Naturalness preserved enhancement algorithm for non-uniform illumination images</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">S</forename><surname>Wang</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><surname>Zheng</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">H</forename><forename type="middle">M</forename><surname>Hu</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">B</forename><surname>Li</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">IEEE Trans. Image Process</title>
		<imprint>
			<biblScope unit="volume">22</biblScope>
			<biblScope unit="issue">9</biblScope>
			<biblScope unit="page" from="3538" to="3548" />
			<date type="published" when="2013" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b33">
	<analytic>
		<title level="a" type="main">A variational model with barrier functionals for Retinex</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">W</forename><surname>Wang</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">C</forename><surname>He</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">SIAM J. Imaging Sci</title>
		<imprint>
			<biblScope unit="volume">8</biblScope>
			<biblScope unit="issue">3</biblScope>
			<biblScope unit="page" from="1955" to="1980" />
			<date type="published" when="2015" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b34">
	<analytic>
		<title level="a" type="main">A nonlocal total variation model for image decomposition: illumination and reflectance</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">W</forename><surname>Wang</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><forename type="middle">K</forename><surname>Ng</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Numerical Mathematics: Theory, Methods and Applications</title>
		<imprint>
			<biblScope unit="volume">7</biblScope>
			<biblScope unit="issue">3</biblScope>
			<biblScope unit="page" from="334" to="355" />
			<date type="published" when="2014" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b35">
	<monogr>
		<title level="m" type="main">The extended Yale face database B</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Yale</forename></persName>
		</author>
		<ptr target="http://vision.ucsd.edu/˜iskwak/" />
		<imprint>
			<date type="published" when="2001" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b36">
	<monogr>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">/</forename><surname>Extyaledatabase</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><surname>Extyaleb</surname></persName>
		</author>
		<imprint/>
	</monogr>
</biblStruct>

<biblStruct xml:id="b37">
	<analytic>
		<title level="a" type="main">A spatial extension of CIELAB for digital color image reproduction</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">X</forename><surname>Zhang</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">B</forename><forename type="middle">A</forename><surname>Wandell</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">SID international symposium digest of technical papers</title>
		<imprint>
			<date type="published" when="1996" />
			<biblScope unit="volume">27</biblScope>
			<biblScope unit="page" from="731" to="734" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b38">
	<analytic>
		<title level="a" type="main">A closed-form solution to retinex with nonlocal texture constraints</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Q</forename><surname>Zhao</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">P</forename><surname>Tan</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Q</forename><surname>Dai</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">L</forename><surname>Shen</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">E</forename><surname>Wu</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">S</forename><surname>Lin</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">IEEE Trans. Pattern Anal. Mach. Intell</title>
		<imprint>
			<biblScope unit="volume">34</biblScope>
			<biblScope unit="issue">7</biblScope>
			<biblScope unit="page" from="1437" to="1444" />
			<date type="published" when="2012" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b39">
	<analytic>
		<title level="a" type="main">Non-local Retinexa unifying framework and beyond</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">D</forename><surname>Zosso</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">G</forename><surname>Tran</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">S</forename><forename type="middle">J</forename><surname>Osher</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">SIAM J. Imaging Sci</title>
		<imprint>
			<biblScope unit="volume">8</biblScope>
			<biblScope unit="issue">2</biblScope>
			<biblScope unit="page" from="787" to="826" />
			<date type="published" when="2015" />
		</imprint>
	</monogr>
</biblStruct>

				</listBibl>
			</div>
		</back>
	</text>
</TEI>
